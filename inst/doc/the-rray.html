<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>The rray</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">The rray</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(rray)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(vctrs)</a></code></pre></div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>rray provides a new array class that changes some of the behavior with base R arrays that I think could be altered to result in code that is more predictable and easy to program around. In the same spirit as <a href="https://tibble.tidyverse.org/">tibble</a>, rrays do less than base R arrays to try and work as consistently and intuitively as possible.</p>
</div>
<div id="subsetting" class="section level2">
<h2>Subsetting</h2>
<div id="the-problem" class="section level3">
<h3>The problem</h3>
<p>Base R subsets matrices and arrays with a default of <code>drop = TRUE</code>, similar to data frames. This is one of the most common sources of bugs, especially when programming around arrays, because a lot of mental work is required to ensure that functions don’t accidentally subset matrices in a way that coerces them to vectors.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">x_mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">x_mat</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; [1,]    1    4</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; [2,]    2    5</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; [3,]    3    6</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">x_mat[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; [1,]    1    4</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; [2,]    2    5</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">x_mat[1L,]</a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; [1] 1 4</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2-16" data-line-number="16">x_mat[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; [1,]    1    4</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; [2,]    2    5</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; [3,]    3    6</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"></a>
<a class="sourceLine" id="cb2-22" data-line-number="22">x_mat[,1L]</a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; [1] 1 2 3</span></a></code></pre></div>
<p>This example demonstrates that <code>[</code> is not <em>type stable</em>. This means it is impossible to predict the type of the output solely based on the input’s type. <em>Type</em> is defined in the vctrs sense (read about it <a href="https://vctrs.r-lib.org/articles/type-size.html">here</a>), but for usage in rray think of the type as being the class of an object along with its attributes, and the <em>shape</em> of the object, which is the dimensionality of the array excluding the first dimension. The first dimension is handled separately as the <em>size</em>.</p>
<p>To give a concrete example, <code>x_mat</code> has a type of <code>&lt;integer[,2]&gt;</code>. Both <code>1:2</code> and <code>1L</code> have types of <code>&lt;integer&gt;</code>. So the full subset expression looks like: <code>&lt;integer[,2]&gt;[&lt;integer&gt;,]</code>. If <code>[</code> was type stable, you would be able to predict the output’s type based on these inputs. But you can’t! In some cases, this returns <code>&lt;integer[,2]&gt;</code>, and in others it returns <code>&lt;integer&gt;</code>.</p>
<p>Looking past the type instability, the fix for the dropping of dimensions is usually to use <code>drop = FALSE</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">x_mat[<span class="dv">1</span>, , drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; [1,]    1    4</span></a></code></pre></div>
<p>But this requires careful thinking about how to subset arrays programmatically, adding the right number of commas where required to ensure that dimensions aren’t dropped. Consider how you would pull the first row of a 3D vs 4D array, and pay attention to the varying number of commas required to prevent a vector from being returned.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">x_3D &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">x_4D &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">x_3D[<span class="dv">1</span>, , , drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; [1,]    1    3    5</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; [1,]    7    9   11</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"></a>
<a class="sourceLine" id="cb4-15" data-line-number="15">x_4D[<span class="dv">1</span>, , , , drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; , , 1, 1</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; [1,]    1    3    5</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; , , 2, 1</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; [1,]    7    9   11</span></a></code></pre></div>
</div>
<div id="the-solution" class="section level3">
<h3>The solution</h3>
<p>rray takes a different approach, and never drops dimensions when subsetting. This results in a type stable <code>[</code> method, and actually frees up subsetting syntax that I find more intuitive, but results in an error with base R. To convert <code>x_3D</code> to an rray, use <code>as_rray()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">x_3D_rray &lt;-<span class="st"> </span><span class="kw">as_rray</span>(x_3D)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># First row, but still 3D</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">x_3D_rray[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,2][1]&gt;</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; [1,]    1    3    5</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; [1,]    7    9   11</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co"># Trailing commas are ignored, so this is the same as above</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17">x_3D_rray[<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,2][1]&gt;</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; [1,]    1    3    5</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt; [1,]    7    9   11</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co"># In base R this is an error</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30">x_3D[<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="co">#&gt; Error in x_3D[1, ]: incorrect number of dimensions</span></a></code></pre></div>
<p>This type stability makes rrays more predictable to program around. Whether subsetting one element or multiple elements from a specific dimension, you can know that the output will have a consistent type.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">x_3D_rray[, 1L]</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; &lt;rray&lt;int&gt;[,1,2][2]&gt;</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; [1,]    1</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; [2,]    2</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; [1,]    7</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; [2,]    8</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"></a>
<a class="sourceLine" id="cb6-15" data-line-number="15">x_3D_rray[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; &lt;rray&lt;int&gt;[,2,2][2]&gt;</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; [1,]    1    3</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; [2,]    2    4</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; [1,]    7    9</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; [2,]    8   10</span></a></code></pre></div>
<p>If you are writing a package where you aren’t sure if the user is going to pass in an rray or an array, you’ll want to be sure that you can subset consistently, no matter the input type. For that, <code>rray_subset()</code> has been exposed, which is what powers <code>[</code>. This means you can have this type stable subsetting with base R objects.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">x_3D[<span class="dv">1</span>, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; Error in x_3D[1, 1]: incorrect number of dimensions</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw">rray_subset</span>(x_3D, <span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; [1,]    1</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; [1,]    7</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co"># Same as with the rray</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="kw">rray_subset</span>(x_3D_rray, <span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; &lt;rray&lt;int&gt;[,1,2][1]&gt;</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; [1,]    1</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt; [1,]    7</span></a></code></pre></div>
</div>
</div>
<div id="subsetting-by-position" class="section level2">
<h2>Subsetting by position</h2>
<div id="the-problem-1" class="section level3">
<h3>The problem</h3>
<p>Base R allows you to access “inner” elements of an array by using <code>[</code> without any commas, i.e. <code>x[i]</code>. While technically this one operation on its own is type stable, when you compare it to <code>x[i,]</code> and <code>x[,i]</code>, it becomes clear that it is doing something completely different.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Positions 1 and 2</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">x_3D[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; [1] 1 2</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co"># Positions 2 and 3</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co"># Correspond to elements at indices: </span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co"># (2, 1, 1) and (1, 2, 1)</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">x_3D[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; [1] 2 3</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="kw">rray_dim</span>(x_3D[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="kw">rray_dim</span>(x_3D[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,,])</a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; [1] 2 3 2</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="kw">rray_dim</span>(x_3D[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,])</a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; [1] 2 2 2</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="kw">rray_dim</span>(x_3D[,,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; [1] 2 3 2</span></a></code></pre></div>
<p>I think that this is a completely separate operation, called <em>subsetting by position</em>. The traditional behavior of <code>x[i, j, ...]</code> is called <em>subsetting by index</em>.</p>
</div>
<div id="the-solution-1" class="section level3">
<h3>The solution</h3>
<p>As seen briefly in the subsetting section, rrays never drop dimensions, and ignore trailing commas when subsetting. This means that <code>x[i]</code> selects rows from <code>x</code>, not positions.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">x_3D_rray[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,2][1]&gt;</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; [1,]    2    4    6</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; [1,]    8   10   12</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co"># Same as this</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14">x_3D_rray[<span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,2][1]&gt;</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; [1,]    2    4    6</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; [1,]    8   10   12</span></a></code></pre></div>
<p>This behavior results in a nice symmetrical predictable behavior that is easy to see if you draw out the different operations. Just by adding commas, we go from selecting rows, to columns, to elements in the third dimension. The type is stable the entire time.</p>
<pre><code>x[i]
x[,i]
x[,,i]</code></pre>
<p>Because trailing commas are ignored, the following are also equivalent to the above explanation.</p>
<pre><code>x[i,]
x[,i,]
x[,,i,]</code></pre>
<p>But what about selecting by position? This is still a useful operation, so it would make sense to have some way to do it. For that, you can equivalently use either <code>rray_yank()</code> or <code>[[</code>. <code>rray_yank()</code> always returns a 1D vector, and allows you to pass in an integer vector to subset by position.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># First 3 positions</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">x_3D_rray[[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]]</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; [1] 1 2 3</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw">rray_yank</span>(x_3D_rray, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; [1] 1 2 3</span></a></code></pre></div>
<p>There are assignment variations of these as well, which are very useful for replacing <code>NA</code> values if you combine it with the other type of object that <code>i</code> can be, a logical with the same dimensions as <code>x</code>. <code>TRUE</code> values are interpreted as the positions to subset.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">dummy &lt;-<span class="st"> </span>x_3D_rray</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co"># Set the first row to NA</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">dummy[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co"># Set NA values to 0</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">dummy[[<span class="kw">is.na</span>(dummy)]] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">dummy</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,2][2]&gt;</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; [1,]    0    0    0</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; [2,]    2    4    6</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co">#&gt; [1,]    0    0    0</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">#&gt; [2,]    8   10   12</span></a></code></pre></div>
<p>The 3rd arm of subsetting is when you want to subset <em>by index</em> like <code>rray_subset()</code>, but you want to actually drop the dimensions like <code>rray_yank()</code>. This is accomplished with <code>rray_extract()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">rray_subset</span>(x_3D_rray, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,2][1]&gt;</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; [1,]    1    3    5</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; [1,]    7    9   11</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="kw">rray_extract</span>(x_3D_rray, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; [1]  1  3  5  7  9 11</span></a></code></pre></div>
</div>
</div>
<div id="dimension-names" class="section level2">
<h2>Dimension Names</h2>
<div id="the-problem-2" class="section level3">
<h3>The problem</h3>
<p>Base R has consistent dimension name handling rules, but they can be surprising because they often don’t retain the maximum amount of information that it seems like they could.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">x_row_nms &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;r1&quot;</span>, <span class="st">&quot;r2&quot;</span>)))</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">x_col_nms &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="ot">NULL</span>, <span class="kw">c</span>(<span class="st">&quot;c1&quot;</span>)))</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">x_row_nms</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt;    [,1]</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; r1    1</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; r2    2</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"></a>
<a class="sourceLine" id="cb15-9" data-line-number="9">x_col_nms</a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt;      c1</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; [1,]  1</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt; [2,]  2</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co"># names from x_row_nms are used</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15">x_row_nms <span class="op">+</span><span class="st"> </span>x_col_nms</a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#&gt;    [,1]</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#&gt; r1    2</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="co">#&gt; r2    4</span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="co"># names from x_col_nms are used</span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21">x_col_nms <span class="op">+</span><span class="st"> </span>x_row_nms</a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">#&gt;      c1</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="co">#&gt; [1,]  2</span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24"><span class="co">#&gt; [2,]  4</span></a></code></pre></div>
<p>It is reasonable that dimension names from both inputs could be used here.</p>
</div>
<div id="the-solution-2" class="section level3">
<h3>The solution</h3>
<p>rray has a different set of dimension name reconciliation rules that attempts to pull names from all inputs.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">x_row_nms_rray &lt;-<span class="st"> </span><span class="kw">as_rray</span>(x_row_nms)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">x_col_nms_rray &lt;-<span class="st"> </span><span class="kw">as_rray</span>(x_col_nms)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">x_row_nms_rray <span class="op">+</span><span class="st"> </span>x_col_nms_rray</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt; &lt;rray&lt;int&gt;[,1][2]&gt;</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt;    c1</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; r1  2</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt; r2  4</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"></a>
<a class="sourceLine" id="cb16-10" data-line-number="10">x_col_nms_rray <span class="op">+</span><span class="st"> </span>x_row_nms_rray</a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#&gt; &lt;rray&lt;int&gt;[,1][2]&gt;</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">#&gt;    c1</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="co">#&gt; r1  2</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">#&gt; r2  4</span></a></code></pre></div>
<p>The order of the inputs still matters. If both inputs have row names, for example, the row names of the result come from the first input.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">x_col_and_row_nms_rray &lt;-<span class="st"> </span><span class="kw">rray_set_row_names</span>(x_col_nms_rray, <span class="kw">c</span>(<span class="st">&quot;row1&quot;</span>, <span class="st">&quot;row2&quot;</span>))</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">x_col_and_row_nms_rray</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt; &lt;rray&lt;int&gt;[,1][2]&gt;</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt;      c1</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt; row1  1</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt; row2  2</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">x_row_nms_rray <span class="op">+</span><span class="st"> </span>x_col_and_row_nms_rray</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">#&gt; &lt;rray&lt;int&gt;[,1][2]&gt;</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">#&gt;    c1</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">#&gt; r1  2</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co">#&gt; r2  4</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"></a>
<a class="sourceLine" id="cb17-14" data-line-number="14">x_col_and_row_nms_rray <span class="op">+</span><span class="st"> </span>x_row_nms_rray</a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="co">#&gt; &lt;rray&lt;int&gt;[,1][2]&gt;</span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co">#&gt;      c1</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="co">#&gt; row1  2</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"><span class="co">#&gt; row2  4</span></a></code></pre></div>
<p>This approach emphasizes maintaining the maximum amount of information possible. The underlying engine for dimension name handling is <code>rray_dim_names_common()</code>. Pass it multiple inputs and it will return the common dimension names using rray’s rules.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">rray_dim_names_common</span>(x_row_nms, x_col_nms)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; [1] &quot;r1&quot; &quot;r2&quot;</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt; [1] &quot;c1&quot;</span></a></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
